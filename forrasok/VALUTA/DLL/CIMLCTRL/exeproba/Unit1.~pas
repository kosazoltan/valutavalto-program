unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls, StdCtrls, Buttons, IBDatabase, DB, IBCustomDataSet,
  IBQuery;

type
  TForm1 = class(TForm)
    BitBtn1: TBitBtn;
    BitBtn2: TBitBtn;
    Panel1: TPanel;
    HQUERY: TIBQuery;
    HDBASE: TIBDatabase;
    HTRANZ: TIBTransaction;
    Label1: TLabel;
    R1: TRadioButton;
    R2: TRadioButton;
    R3: TRadioButton;
    R4: TRadioButton;
    R5: TRadioButton;
    R6: TRadioButton;
    R7: TRadioButton;
    Label2: TLabel;
    GroupBox1: TGroupBox;
    procedure BitBtn2Click(Sender: TObject);
    procedure BitBtn1Click(Sender: TObject);
    procedure Hparancs(_ukaz: string);
    procedure FormActivate(Sender: TObject);


  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  _ok: integer;
  _R : array[1..7] of TradioButton;
  _pcs: string;


function cimletctrlrutin: integer; stdcall; EXTERNAL 'c:\valuta\bin\cimlctrl.dll'
                      name 'cimletctrlrutin';

implementation

{$R *.dfm}

procedure TForm1.BitBtn2Click(Sender: TObject);
begin
  Application.Terminate;
end;

procedure TForm1.BitBtn1Click(Sender: TObject);


var _y: byte;

begin
  _y := 1;
  while _y<=7 do
    begin
      if _r[_y].Checked then break;
      inc(_y);
    end;
  if _y=8 then exit;

 _pcs := 'UPDATE HARDWARE SET MENETSZAM=' + inttostr(_y);
 Hparancs(_pcs);

  _ok := cimletctrlrutin;
  Panel1.Caption := inttostr(_ok);
  Panel1.repaint;
end;

procedure TForm1.Hparancs(_ukaz: string);

begin
  hdbase.connected := true;
  if htranz.InTransaction then htranz.commit;
  Htranz.StartTransaction;
  with Hquery do
    begin
      Close;
      sql.clear;
      sql.add(_ukaz);
      Execsql;
    end;
  Htranz.commit;
  HDbase.close;
end;


procedure TForm1.FormActivate(Sender: TObject);
begin
  _R[1] := r1;
  _R[2] := r2;
  _R[3] := r3;
  _R[4] := r4;
  _R[5] := r5;
  _R[6] := r6;
  _R[7] := r7;
end;

end.
